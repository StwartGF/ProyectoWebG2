@model ProyectoWebG2.Models.AsistenciaFormVM
@{
    Layout = "_LayoutInterno";
    ViewData["Title"] = "Tomar asistencia";
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <div>
        <h2 class="mb-0">Tomar asistencia</h2>
        <p class="text-muted mb-0">Marca el estado para cada estudiante.</p>
    </div>
    <a class="btn btn-outline-primary" asp-action="Estudiantes" asp-route-cursoId="@Model.CursoId">Volver a estudiantes</a>
</div>

@if (TempData["Msg"] != null)
{
    <div class="alert alert-success">@TempData["Msg"]</div>
}
@if (TempData["Error"] != null)
{
    <div class="alert alert-danger">@TempData["Error"]</div>
}

<form asp-action="Asistencia" method="post">
    @Html.AntiForgeryToken()
    <input type="hidden" asp-for="CursoId" />

    <div class="mb-3">
        <label asp-for="Fecha" class="form-label fw-semibold">Fecha</label>
        <input asp-for="Fecha" class="form-control" type="date" />
    </div>

    <div class="card shadow-sm">
        <div class="card-body p-0">
            <table class="table table-hover mb-0 align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Estudiante</th>
                        <th style="width:200px;">Estado</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model.Items != null && Model.Items.Any())
                    {
                        for (int i = 0; i < Model.Items.Count; i++)
                        {
                            <tr>
                                <td>
                                    <input type="hidden" asp-for="Items[i].IdUsuario" />
                                    <input type="hidden" asp-for="Items[i].NombreCompleto" />
                                    @Model.Items[i].NombreCompleto
                                </td>
                                <td>
                                    <select asp-for="Items[i].EstadoAsistencia" class="form-select form-select-sm">
                                        <option>Presente</option>
                                        <option>Ausente</option>
                                        <option>Tarde</option>
                                    </select>
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="2" class="text-center py-4 text-muted">
                                No hay estudiantes para registrar asistencia.
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <div class="mt-3 d-flex justify-content-end">
        <button type="submit" class="btn btn-primary">Guardar asistencia</button>
    </div>
</form>
